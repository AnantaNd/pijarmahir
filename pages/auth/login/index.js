import Head from 'next/head';
import Image from 'next/image';
import React, { useEffect, useState } from 'react';
import CardLogin from '../../../components/Card/CardLogin/CardLogin';
import FooterSecond from '../../../components/Footer/FooterSecond/FooterSecond';
import Styles from './Login.module.css';

function Login({props}) {
  const [email, setEmail] = useState('')
  const [pass, setPass] = useState('')
  const [isEmail, setIsEmail] = useState(false)
  const [isPass, setIsPass] = useState(false)



  // console.log(props.data)

  const handleInputEmail = (e) => {
    setEmail(e.target.value)
    // console.log(e.target.value)
  }
  const handleInputPass = (e) => {
    setPass(e.target.value)
    // console.log(e.target.value)
  }

  useEffect(()=>{
    // const userEmail = props.data.find(user=>user.email === email)
    // const userPass = props.data.find(user=>user.password === pass)
    // console.log(isEmail)
    // console.log(isPass)
    props.data.map((user)=>{
      if(email === user.email && pass === user.password){
        setIsEmail(true)
        setIsPass(true)
        console.log(user)
      }else{
        setIsEmail(false)
        
      }
    })

  })

  return (
    <>
      <Head>
        <title>Pijar | Login</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/pijar_logo.svg" />
      </Head>
      <main className={Styles.container_login}>
        <Image className={Styles.logo} src="/pijar_logo.svg" height={80} width={80} style={{ marginLeft: "auto", marginRight: "auto" }} alt='logo' />
        <div className={Styles.login_content}>
          <Image className={Styles.login_ilustration} src="/new-profile.svg" width={480} height={480} alt='ilustration' />
          <CardLogin inputUsername={handleInputEmail} inputPassword={handleInputPass} helpers={`${isEmail === true ? '': 'password dan email tidak cocok'}`}/>
        </div>
      </main>
      <FooterSecond />
    </>
  )
}

export default Login
export const getStaticProps = async () =>{
  try{
    const res = fetch('http://localhost:9000/api/v1/user/')
    const data = await res.json()
    return{
      props: {props: data}
    }
  }catch(err){
    console.log(err)
    throw(err)
  }
}